(window.webpackJsonp=window.webpackJsonp||[]).push([[97],{1500:function(e,t,s){"use strict";s.r(t);s(33),s(81),s(9),s(22);var n=s(861),r={__name:"Header",props:{responseSourcePath:{type:String,required:!0},responseSourceName:{type:String,required:!0}},setup:function(e){return{__sfc:!0}}},a=s(8),o=Object(a.a)(r,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("header",{staticClass:"flex items-center px-8 py-4 bg-white border-b border-slate-100",attrs:{role:"banner"}},[t("a",{staticClass:"text-woot-500 hover:underline mr-4",attrs:{href:e.responseSourcePath}},[e._v("\n    "+e._s("Back")+"\n  ")]),e._v(" "),t("div",{staticClass:"border border-solid border-slate-100 text-slate-700 mr-4 p-2 rounded-full"},[t("svg",{attrs:{width:"24",height:"24"}},[t("use",{attrs:{"xlink:href":"#icon-mist-fill"}})])]),e._v(" "),t("div",{staticClass:"flex flex-col h-14 justify-center"},[t("h1",{staticClass:"text-base font-medium text-slate-900",attrs:{id:"page-title"}},[e._v("\n      "+e._s("Robin AI playground")+"\n    ")]),e._v(" "),t("p",{staticClass:"text-sm text-slate-600"},[e._v("\n      "+e._s("Chat with the source")+"\n      "),t("span",{staticClass:"font-medium"},[e._v("\n        "+e._s(e.responseSourceName)+"\n      ")]),e._v("\n      "+e._s("and evaluate it\u2019s efficiency.")+"\n    ")])])])}),[],!1,null,null,null).exports,i={__name:"UserMessage",props:{message:{type:String,required:!0}},setup:function(e){return{__sfc:!0}}},l=Object(a.a)(i,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"w-full mb-4 flex items-center justify-end"},[t("div",{directives:[{name:"dompurify-html",rawName:"v-dompurify-html",value:e.message,expression:"message"}],staticClass:"px-4 py-3 bg-woot-400 text-white text-sm rounded-md inline-block"})])}),[],!1,null,null,null).exports,u={__name:"BotMessage",props:{message:{type:String,required:!0}},setup:function(e){return{__sfc:!0}}},c=Object(a.a)(u,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"w-full mb-4 flex items-center justify-start"},[t("div",{directives:[{name:"dompurify-html",rawName:"v-dompurify-html",value:e.message,expression:"message"}],staticClass:"px-4 py-3 bg-white max-w-4xl text-slate-700 leading-6 text-sm rounded-md inline-block border border-slate-100"})])}),[],!1,null,null,null).exports,p=s(2152),d=s.n(p),f={__name:"TypingIndicator",setup:function(e){return{__sfc:!0,TypingIndicator:d.a}}};function g(e,t,s,n,r,a,o){try{var i=e[a](o),l=i.value}catch(u){return void s(u)}i.done?t(l):Promise.resolve(l).then(n,r)}var m={components:{PlaygroundHeader:o,UserMessage:l,BotMessage:c,TypingIndicator:Object(a.a)(f,(function(){var e=this._self._c;return e("div",{staticClass:"w-full mb-4 flex items-center justify-start"},[e("div",{staticClass:"px-2 py-2 bg-white max-w-4xl text-slate-700 leading-6 text-sm rounded-md inline-block border border-slate-100"},[e("img",{staticClass:"h-4",attrs:{src:this._self._setupProxy.TypingIndicator,alt:"TypingIndicator"}})])])}),[],!1,null,null,null).exports},props:{componentData:{type:Object,default:function(){return{}}}},setup:function(){return{formatMessage:Object(n.a)().formatMessage}},data:function(){return{messages:[],messageContent:"",isWaiting:!1}},computed:{previousMessages:function(){return this.messages.map((function(e){return{type:e.type,message:e.content}}))}},mounted:function(){this.focusInput()},methods:{focusInput:function(){this.$refs.messageInput.focus()},onMessageSend:function(){this.addMessageToData("User",this.messageContent),this.sendMessageToServer(this.messageContent)},scrollToLastMessage:function(){var e=this;this.$nextTick((function(){var t=e.messages[e.messages.length-1].id;document.getElementById("message-".concat(t)).scrollIntoView({behavior:"smooth"})}))},addMessageToData:function(e,t){this.messages.push({id:this.messages.length,type:e,content:t}),this.scrollToLastMessage()},sendMessageToServer:function(e){var t,s=this;return(t=regeneratorRuntime.mark((function t(){var n,r,a,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s.messageContent="",s.isWaiting=!0,n=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),t.prev=3,t.next=6,fetch(window.location.href,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":n},body:JSON.stringify({message:e,previous_messages:s.previousMessages}),credentials:"include"});case 6:if((r=t.sent).ok){t.next=9;break}throw new Error("HTTP error! status: ".concat(r.status));case 9:return t.next=11,r.json();case 11:a=t.sent,o=a.message,s.addMessageToData("Bot",o),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(3),s.addMessageToData("bot","Error: Could not retrieve response. Please check the console for more details.");case 19:return t.prev=19,s.isWaiting=!1,s.focusInput(),t.finish(19);case 23:case"end":return t.stop()}}),t,null,[[3,16,19,23]])})),function(){var e=this,s=arguments;return new Promise((function(n,r){var a=t.apply(e,s);function o(e){g(a,n,r,o,i,"next",e)}function i(e){g(a,n,r,o,i,"throw",e)}o(void 0)}))})()}}},h=m,v=Object(a.a)(h,(function(){var e=this,t=e._self._c;return t("section",{staticClass:"flex flex-col w-full h-full bg-slate-25"},[t("PlaygroundHeader",{attrs:{"response-source-name":e.componentData.responseSourceName,"response-source-path":e.componentData.responseSourcePath}}),e._v(" "),t("div",{staticClass:"flex-1 px-8 py-4 overflow-auto"},[e._l(e.messages,(function(s){return t("div",{key:s.id,attrs:{id:`message-${s.id}`}},["User"===s.type?t("UserMessage",{attrs:{message:e.formatMessage(s.content)}}):t("BotMessage",{attrs:{message:e.formatMessage(s.content)}})],1)})),e._v(" "),e.isWaiting?t("TypingIndicator"):e._e()],2),e._v(" "),t("div",{staticClass:"w-full px-8 py-6"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.messageContent,expression:"messageContent"}],ref:"messageInput",staticClass:"resize-none block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border !outline-2 border-slate-100 focus:ring-woot-500 focus:border-woot-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-woot-500 dark:focus:border-woot-500",attrs:{rows:4,placeholder:"Type a message... [CMD/CTRL + Enter to send]",autofocus:"",autocomplete:"off"},domProps:{value:e.messageContent},on:{keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.metaKey?e.onMessageSend.apply(null,arguments):null},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey?e.onMessageSend.apply(null,arguments):null}],input:function(t){t.target.composing||(e.messageContent=t.target.value)}}})])],1)}),[],!1,null,null,null);t.default=v.exports},2152:function(e,t,s){e.exports=s.p+"media/superadmin_pages/components/playground/assets/typing-929e3aeb589b7668d0b4ff57f73e17e3.gif"},861:function(e,t,s){"use strict";s.d(t,"a",(function(){return g}));s(59),s(54),s(73),s(357),s(141),s(14),s(9),s(17),s(20),s(203),s(23);var n=s(863),r=s.n(n),a=(s(375),/mention:\/\/(user|team)\/(\d+)\/(.+)/gm);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(e){e.children.forEach((function(e){"image"===e.type&&function(e){var t=e.attrGet("src");if(t){var s=new URL(t).searchParams.get("cw_image_height");s&&e.attrSet("style","height: ".concat(s,";"))}}(e)}))},u=s(755)({html:!1,xhtmlOut:!0,breaks:!0,langPrefix:"language-",linkify:!0,typographer:!0,quotes:"\u201c\u201d\u2018\u2019",maxNesting:20}).use((function(e){e.renderer.rules.mention=function(e,t){return'<span class="prosemirror-mention-node">'.concat(e[t].content,"</span>")},e.inline.ruler.before("link","mention",(function(e,t){var s,n,r,o,i,l,u="",c=e.posMax;return 91===e.src.charCodeAt(e.pos)&&(r=e.pos+1,!((n=e.md.helpers.parseLinkLabel(e,e.pos,!0))<0)&&(s=e.src.slice(r,n),(o=n+1)<c&&40===e.src.charCodeAt(o)&&(o+=1,(i=e.md.helpers.parseLinkDestination(e.src,o,e.posMax)).ok&&(u=e.md.normalizeLink(i.str),e.md.validateLink(u)?o=i.pos:u=""),o+=1),!!u.match(new RegExp(a))&&(t||(e.pos=r,e.posMax=n,(l=e.push("mention","")).href=u,l.content=s),e.pos=o,e.posMax=c,!0)))}))})).use((function(e){e.core.ruler.after("inline","add-image-height",(function(e){e.tokens.forEach((function(e){"inline"===e.type&&l(e)}))}))})).use(r.a,{attrs:{class:"link",rel:"noreferrer noopener nofollow",target:"_blank"}}),c=/(^|[^@\w])@(\w{1,15})\b/g,p=/(^|\s)#(\w+)/g,d=function(){function e(t){var s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];o(this,e),this.message=t||"",this.isAPrivateNote=n,this.isATweet=s}var t,s,n;return t=e,(s=[{key:"formatMessage",value:function(){var e=this.message;return this.isATweet&&!this.isAPrivateNote&&(e=(e=e.replace(c,"$1[@$2](http://twitter.com/$2)")).replace(p,"$1[#$2](https://twitter.com/hashtag/$2)")),u.render(e)}},{key:"formattedMessage",get:function(){return this.formatMessage()}},{key:"plainText",get:function(){return(new DOMParser).parseFromString(this.formattedMessage,"text/html").body.textContent||""}}])&&i(t.prototype,s),n&&i(t,n),e}(),f=d,g=function(){var e=function(e,t){return new f(e,t).plainText};return{formatMessage:function(e,t,s){return new f(e,t,s).formattedMessage},getPlainText:e,truncateMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.length<100?e:"".concat(e.slice(0,97),"...")},highlightContent:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=e(t),a=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return r.replace(new RegExp("(".concat(a,")"),"ig"),'<span class="'.concat(n,'">$1</span>'))}}}}}]);
//# sourceMappingURL=97-39ca49f688bf1dd64206.chunk.js.map