(window.webpackJsonp=window.webpackJsonp||[]).push([[124],{2217:function(t,e,n){"use strict";n.r(e);n(33),n(51),n(24),n(10),n(21),n(29),n(23),n(30),n(9),n(22);var o=n(327),i=n(38),r=n(64),s=n(5),a=n(197),l=function(t){var e=Object(a.a)("integrations/getIntegration"),n=Object(s.computed)((function(){return e.value(t)})),o=Object(s.computed)((function(){return"inbox"===n.value.hook_type})),i=Object(s.computed)((function(){return!!n.value.hooks.length})),r=Object(s.computed)((function(){return n.value.allow_multiple_hooks?"multiple":"single"})),l=Object(s.computed)((function(){return"multiple"===r.value})),u=Object(s.computed)((function(){return"single"===r.value}));return{integration:n,integrationType:r,isIntegrationMultiple:l,isIntegrationSingle:u,isHookTypeInbox:o,hasConnectedHooks:i}};n(81),n(75),n(91),n(44),n(14),n(20);function u(t,e,n,o,i,r,s){try{var a=t[r](s),l=a.value}catch(u){return void n(u)}a.done?e(l):Promise.resolve(l).then(o,i)}function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){p(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function p(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f={props:{integrationId:{type:String,required:!0}},setup:function(t){var e=l(t.integrationId);return{integration:e.integration,isHookTypeInbox:e.isHookTypeInbox}},data:function(){return{endPoint:"",alertMessage:"",values:{}}},computed:d(d({},Object(i.mapGetters)({uiFlags:"integrations/getUIFlags",dialogFlowEnabledInboxes:"inboxes/dialogFlowEnabledInboxes"})),{},{inboxes:function(){var t=this;return this.dialogFlowEnabledInboxes.filter((function(e){return!t.isIntegrationDialogflow||!t.connectedDialogflowInboxIds.includes(e.id)})).map((function(t){return{label:t.name,value:t.id}}))},connectedDialogflowInboxIds:function(){return this.isIntegrationDialogflow?this.integration.hooks.map((function(t){var e;return null===(e=t.inbox)||void 0===e?void 0:e.id})):[]},formItems:function(){return this.integration.settings_form_schema},isIntegrationDialogflow:function(){return"dialogflow"===this.integration.id}}),methods:{onClose:function(){this.$emit("close")},buildHookPayload:function(){var t=this,e={app_id:this.integration.id,settings:{}};return e.settings=Object.keys(this.values).reduce((function(e,n){return"inbox"!==n&&(e[n]=t.values[n]),e}),{}),this.formItems.forEach((function(t){t.validation.includes("JSON")&&(e.settings[t.name]=JSON.parse(e.settings[t.name]))})),this.isHookTypeInbox&&this.values.inbox&&(e.inbox_id=this.values.inbox),e},submitForm:function(){var t,e=this;return(t=regeneratorRuntime.mark((function t(){var n,o,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$store.dispatch("integrations/createHook",e.buildHookPayload());case 3:e.alertMessage=e.$t("INTEGRATION_APPS.ADD.API.SUCCESS_MESSAGE"),e.onClose(),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),i=null===t.t0||void 0===t.t0||null===(n=t.t0.response)||void 0===n||null===(o=n.data)||void 0===o?void 0:o.message,e.alertMessage=i||e.$t("INTEGRATION_APPS.ADD.API.ERROR_MESSAGE");case 11:return t.prev=11,Object(r.a)(e.alertMessage),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,7,11,14]])})),function(){var e=this,n=arguments;return new Promise((function(o,i){var r=t.apply(e,n);function s(t){u(r,o,i,s,a,"next",t)}function a(t){u(r,o,i,s,a,"throw",t)}s(void 0)}))})()}}},g=f,b=n(8),h=Object(b.a)(g,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex flex-col h-auto overflow-auto integration-hooks"},[e("woot-modal-header",{attrs:{"header-title":t.integration.name,"header-content":t.integration.description}}),t._v(" "),e("formulate-form",{staticClass:"w-full",on:{submit:t.submitForm},scopedSlots:t._u([{key:"default",fn:function({hasErrors:n}){return[t._l(t.formItems,(function(n){return e("formulate-input",t._b({key:n.name},"formulate-input",n,!1))})),t._v(" "),t.isHookTypeInbox?e("formulate-input",{attrs:{options:t.inboxes,type:"select",name:"inbox",placeholder:t.$t("INTEGRATION_APPS.ADD.FORM.INBOX.LABEL"),label:t.$t("INTEGRATION_APPS.ADD.FORM.INBOX.PLACEHOLDER"),validation:"required","validation-name":"Inbox"}}):t._e(),t._v(" "),e("div",{staticClass:"flex flex-row justify-end w-full gap-2 px-0 py-2"},[e("woot-button",{attrs:{disabled:n,loading:t.uiFlags.isCreatingHook}},[t._v("\n        "+t._s(t.$t("INTEGRATION_APPS.ADD.FORM.SUBMIT"))+"\n      ")]),t._v(" "),e("woot-button",{staticClass:"button clear",on:{click:function(e){return e.preventDefault(),t.onClose.apply(null,arguments)}}},[t._v("\n        "+t._s(t.$t("INTEGRATION_APPS.ADD.FORM.CANCEL"))+"\n      ")])],1)]}}]),model:{value:t.values,callback:function(e){t.values=e},expression:"values"}})],1)}),[],!1,null,null,null),v=h.exports,m={props:{integrationId:{type:String,required:!0}},setup:function(t){var e=l(t.integrationId);return{integration:e.integration,hasConnectedHooks:e.hasConnectedHooks}}},I=Object(b.a)(m,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex-shrink flex-grow overflow-auto p-4"},[e("div",{staticClass:"flex flex-col"},[e("div",{staticClass:"bg-white dark:bg-slate-800 border border-solid border-slate-75 dark:border-slate-700/50 rounded-xl mb-4 p-4"},[e("div",{staticClass:"flex"},[e("div",{staticClass:"flex h-[6.25rem] w-[6.25rem]"},[e("img",{staticClass:"max-w-full rounded-md border border-slate-50 dark:border-slate-700/50 shadow-sm block dark:hidden bg-white dark:bg-slate-900",attrs:{src:`/dashboard/images/integrations/${t.integration.id}.png`}}),t._v(" "),e("img",{staticClass:"max-w-full rounded-md border border-slate-50 dark:border-slate-700/50 shadow-sm hidden dark:block bg-white dark:bg-slate-900",attrs:{src:`/dashboard/images/integrations/${t.integration.id}-dark.png`}})]),t._v(" "),e("div",{staticClass:"flex flex-col justify-center m-0 mx-4 flex-1"},[e("h3",{staticClass:"text-xl font-medium mb-1 text-slate-800 dark:text-slate-100"},[t._v("\n            "+t._s(t.integration.name)+"\n          ")]),t._v(" "),e("p",{staticClass:"text-slate-700 dark:text-slate-200"},[t._v("\n            "+t._s(t.integration.description)+"\n          ")])]),t._v(" "),e("div",{staticClass:"flex justify-center items-center mb-0 w-[15%]"},[t.hasConnectedHooks?e("div",[e("div",{on:{click:function(e){return t.$emit("delete",t.integration.hooks[0])}}},[e("woot-button",{staticClass:"nice alert"},[t._v("\n                "+t._s(t.$t("INTEGRATION_APPS.DISCONNECT.BUTTON_TEXT"))+"\n              ")])],1)]):e("div",[e("woot-button",{staticClass:"button nice",on:{click:function(e){return t.$emit("add")}}},[t._v("\n              "+t._s(t.$t("INTEGRATION_APPS.CONNECT.BUTTON_TEXT"))+"\n            ")])],1)])])])])])}),[],!1,null,null,null).exports;function O(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function T(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?O(Object(n),!0).forEach((function(e){_(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function _(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var E={props:{integrationId:{type:String,required:!0}},setup:function(t){var e=l(t.integrationId);return{integration:e.integration,isHookTypeInbox:e.isHookTypeInbox,hasConnectedHooks:e.hasConnectedHooks}},computed:T(T({},Object(i.mapGetters)({globalConfig:"globalConfig/get"})),{},{hookHeaders:function(){return this.integration.visible_properties},hooks:function(){var t=this;if(!this.hasConnectedHooks)return[];var e=this.integration.hooks;return e.map((function(e){return T(T({},e),{},{id:e.id,properties:t.hookHeaders.map((function(t){return e.settings[t]?e.settings[t]:"--"}))})}))}}),mounted:function(){},methods:{inboxName:function(t){return t.inbox?t.inbox.name:""}}};function w(t,e,n,o,i,r,s){try{var a=t[r](s),l=a.value}catch(u){return void n(u)}a.done?e(l):Promise.resolve(l).then(o,i)}function k(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?k(Object(n),!0).forEach((function(e){N(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function N(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var x={components:{NewHook:v,SingleIntegrationHooks:I,MultipleIntegrationHooks:Object(b.a)(E,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex flex-row gap-4"},[e("div",{staticClass:"w-full lg:w-3/5"},[t.hasConnectedHooks?e("table",{staticClass:"woot-table"},[e("thead",[t._l(t.hookHeaders,(function(n){return e("th",{key:n},[t._v("\n          "+t._s(n)+"\n        ")])})),t._v(" "),t.isHookTypeInbox?e("th",[t._v("\n          "+t._s(t.$t("INTEGRATION_APPS.LIST.INBOX"))+"\n        ")]):t._e()],2),t._v(" "),e("tbody",t._l(t.hooks,(function(n){return e("tr",{key:n.id},[t._l(n.properties,(function(n){return e("td",{key:n,staticClass:"break-words"},[t._v("\n            "+t._s(n)+"\n          ")])})),t._v(" "),t.isHookTypeInbox?e("td",{staticClass:"break-words"},[t._v("\n            "+t._s(t.inboxName(n))+"\n          ")]):t._e(),t._v(" "),e("td",{staticClass:"flex justify-end gap-1"},[e("woot-button",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.$t("INTEGRATION_APPS.LIST.DELETE.BUTTON_TEXT"),expression:"$t('INTEGRATION_APPS.LIST.DELETE.BUTTON_TEXT')",modifiers:{top:!0}}],attrs:{variant:"smooth","color-scheme":"alert",size:"tiny",icon:"dismiss-circle","class-names":"grey-btn"},on:{click:function(e){return t.$emit("delete",n)}}})],1)],2)})),0)]):e("p",{staticClass:"flex flex-col items-center justify-center h-full"},[t._v("\n      "+t._s(t.$t("INTEGRATION_APPS.NO_HOOK_CONFIGURED",{integrationId:t.integration.id}))+"\n    ")])]),t._v(" "),e("div",{staticClass:"hidden w-1/3 lg:block"},[e("p",[e("b",[t._v(t._s(t.integration.name))])]),t._v(" "),e("p",{directives:[{name:"dompurify-html",rawName:"v-dompurify-html",value:t.$t(`INTEGRATION_APPS.SIDEBAR_DESCRIPTION.${t.integration.name.toUpperCase()}`,{installationName:t.globalConfig.installationName}),expression:"\n        $t(\n          `INTEGRATION_APPS.SIDEBAR_DESCRIPTION.${integration.name.toUpperCase()}`,\n          { installationName: globalConfig.installationName }\n        )\n      "}]})])])}),[],!1,null,null,null).exports},props:{integrationId:{type:[String,Number],required:!0}},setup:function(t){var e=t.integrationId,n=l(e);return{integration:n.integration,isIntegrationMultiple:n.isIntegrationMultiple,isIntegrationSingle:n.isIntegrationSingle,isHookTypeInbox:n.isHookTypeInbox}},data:function(){return{loading:{},showAddHookModal:!1,showDeleteConfirmationPopup:!1,selectedHook:{},alertMessage:""}},computed:P(P({},Object(i.mapGetters)({uiFlags:"integrations/getUIFlags"})),{},{showIntegrationHooks:function(){return!this.uiFlags.isFetching&&!Object(o.f)(this.integration)},showAddButton:function(){return this.showIntegrationHooks&&this.isIntegrationMultiple},deleteTitle:function(){return this.isHookTypeInbox?this.$t("INTEGRATION_APPS.DELETE.TITLE.INBOX"):this.$t("INTEGRATION_APPS.DELETE.TITLE.ACCOUNT")},deleteMessage:function(){return this.isHookTypeInbox?this.$t("INTEGRATION_APPS.DELETE.MESSAGE.INBOX"):this.$t("INTEGRATION_APPS.DELETE.MESSAGE.ACCOUNT")},confirmText:function(){return this.isHookTypeInbox?this.$t("INTEGRATION_APPS.DELETE.CONFIRM_BUTTON_TEXT.INBOX"):this.$t("INTEGRATION_APPS.DELETE.CONFIRM_BUTTON_TEXT.ACCOUNT")},cancelText:function(){return this.$t("INTEGRATION_APPS.DELETE.CANCEL_BUTTON_TEXT")}}),methods:{openAddHookModal:function(){this.showAddHookModal=!0},hideAddHookModal:function(){this.showAddHookModal=!1},openDeletePopup:function(t){this.showDeleteConfirmationPopup=!0,this.selectedHook=t},closeDeletePopup:function(){this.showDeleteConfirmationPopup=!1},confirmDeletion:function(){var t,e=this;return(t=regeneratorRuntime.mark((function t(){var n,o,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$store.dispatch("integrations/deleteHook",{hookId:e.selectedHook.id,appId:e.selectedHook.app_id});case 3:e.alertMessage=e.$t("INTEGRATION_APPS.DELETE.API.SUCCESS_MESSAGE"),e.closeDeletePopup(),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),i=null===t.t0||void 0===t.t0||null===(n=t.t0.response)||void 0===n||null===(o=n.data)||void 0===o?void 0:o.message,e.alertMessage=i||e.$t("INTEGRATION_APPS.DELETE.API.ERROR_MESSAGE");case 11:return t.prev=11,Object(r.a)(e.alertMessage),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,7,11,14]])})),function(){var e=this,n=arguments;return new Promise((function(o,i){var r=t.apply(e,n);function s(t){w(r,o,i,s,a,"next",t)}function a(t){w(r,o,i,s,a,"throw",t)}s(void 0)}))})()}}},A=x,y=Object(b.a)(A,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"overflow-auto p-4 max-w-full my-auto flex flex-wrap h-full"},[t.showAddButton?e("woot-button",{attrs:{"color-scheme":"success","class-names":"button--fixed-top",icon:"add-circle"},on:{click:t.openAddHookModal}},[t._v("\n    "+t._s(t.$t("INTEGRATION_APPS.ADD_BUTTON"))+"\n  ")]):t._e(),t._v(" "),t.showIntegrationHooks?e("div",{staticClass:"w-full"},[t.isIntegrationMultiple?e("div",[e("MultipleIntegrationHooks",{attrs:{"integration-id":t.integrationId},on:{delete:t.openDeletePopup}})],1):t._e(),t._v(" "),t.isIntegrationSingle?e("div",[e("SingleIntegrationHooks",{attrs:{"integration-id":t.integrationId},on:{add:t.openAddHookModal,delete:t.openDeletePopup}})],1):t._e()]):t._e(),t._v(" "),e("woot-modal",{attrs:{show:t.showAddHookModal,"on-close":t.hideAddHookModal},on:{"update:show":function(e){t.showAddHookModal=e}}},[e("NewHook",{attrs:{"integration-id":t.integrationId},on:{close:t.hideAddHookModal}})],1),t._v(" "),e("woot-delete-modal",{attrs:{show:t.showDeleteConfirmationPopup,"on-close":t.closeDeletePopup,"on-confirm":t.confirmDeletion,title:t.deleteTitle,message:t.deleteMessage,"confirm-text":t.confirmText,"reject-text":t.cancelText},on:{"update:show":function(e){t.showDeleteConfirmationPopup=e}}})],1)}),[],!1,null,null,null);e.default=y.exports}}]);
//# sourceMappingURL=124-0ffea219daf01b760dbd.chunk.js.map