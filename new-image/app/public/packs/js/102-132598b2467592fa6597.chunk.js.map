{"version":3,"sources":["webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/ReportContainer.vue?fd83","webpack:///./app/javascript/dashboard/composables/useReportMetrics.js","webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/components/ChartElements/ChartStats.vue?11a2","webpack:///ChartStats.vue","webpack:///app/javascript/dashboard/routes/dashboard/settings/reports/ReportContainer.vue","webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/ReportContainer.vue?6b6f","webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/components/ChartElements/ChartStats.vue","webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/components/ChartElements/ChartStats.vue?0922","webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/ReportContainer.vue","webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/components/ReportMetricCard.vue?16fa","webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/components/ReportMetricCard.vue?1611","webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/components/ReportMetricCard.vue","webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/BotReports.vue?b7b3","webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/components/BotMetrics.vue?8c83","webpack:///BotMetrics.vue","webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/components/BotMetrics.vue","webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/components/BotMetrics.vue?ff61","webpack:///app/javascript/dashboard/routes/dashboard/settings/reports/BotReports.vue","webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/BotReports.vue?b91d","webpack:///./app/javascript/dashboard/routes/dashboard/settings/reports/BotReports.vue"],"names":["useReportMetrics","accountSummaryKey","accountSummary","useMapGetter","calculateTrend","key","value","previous","diff","Math","round","isAverageMetricType","includes","displayMetric","formatTime","Number","toLocaleString","props","_vm","this","_c","_self","_setup","_setupProxy","staticClass","_v","_s","metric","NAME","KEY","trend","class","trendColor","_e","_l","attrs","accountReport","isFetching","$t","data","getCollection","getChartOptions","component","ref","disabled","label","directives","name","rawName","expression","conversationCount","messageCount","resolutionRate","handoffRate","fetchMetrics","filters","to","from","getBotMetrics","then","response","conversation_count","message_count","resolution_rate","toString","handoff_rate","deep","ReportMetricCard","formatToPercent","on","onFilterChange","requestPayload","groupBy","reportKeys"],"mappings":"6IAAA,I,wCCSO,SAASA,IAA2D,IAA1CC,EAAyC,uDAArB,oBAC7CC,EAAiBC,YAAaF,GAQ9BG,EAAiB,SAAAC,GACrB,IAAKH,EAAeI,MAAMC,SAASF,GAAM,OAAO,EAChD,IAAMG,EAAON,EAAeI,MAAMD,GAAOH,EAAeI,MAAMC,SAASF,GACvE,OAAOI,KAAKC,MAAOF,EAAON,EAAeI,MAAMC,SAASF,GAAQ,MAS5DM,EAAsB,SAAAN,GAC1B,MAAO,CACL,0BACA,sBACA,cACAO,SAASP,IASPQ,EAAgB,SAAAR,GACpB,OAAIM,EAAoBN,GACfS,YAAWZ,EAAeI,MAAMD,IAElCU,OAAOb,EAAeI,MAAMD,IAAQ,IAAIW,kBAGjD,MAAO,CACLZ,iBACAO,sBACAE,iB,gCCtDqP,E,qKCczP,EAA+Db,EAC7DiB,EAAMhB,mBADAG,EAAR,EAAQA,eAAgBS,EAAxB,EAAwBA,cAAeF,EAAvC,EAAuCA,oB,0FAIpB,SAACL,EAAOD,GACzB,OAAIM,EAAoBN,GACfC,EAAQ,EACX,8BACA,kCAECA,EAAQ,EACX,8BACA,sC,8rBCjBN,ICTuO,EDSvO,CACA,uBEHgB,YACd,GCRW,WAAkB,IAAIY,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAGE,EAAOJ,EAAIG,MAAME,YAAY,OAAOH,EAAG,MAAM,CAACI,YAAY,sCAAsC,CAACJ,EAAG,OAAO,CAACI,YAAY,WAAW,CAACN,EAAIO,GAAG,SAASP,EAAIQ,GAAGR,EAAIS,OAAOC,MAAM,UAAUV,EAAIO,GAAG,KAAKL,EAAG,MAAM,CAACI,YAAY,kBAAkB,CAACJ,EAAG,MAAM,CAACI,YAAY,uBAAuB,CAACN,EAAIO,GAAG,WAAWP,EAAIQ,GAAGJ,EAAOT,cAAcK,EAAIS,OAAOE,MAAM,YAAYX,EAAIO,GAAG,KAAMP,EAAIS,OAAY,MAAEP,EAAG,MAAM,CAACI,YAAY,yCAAyC,CAAEN,EAAIS,OAAOG,MAAQ,EAAGV,EAAG,MAAM,CAACI,YAAY,qEAAqEO,MAAMT,EAAOU,WAAWd,EAAIS,OAAOG,MAAOZ,EAAIS,OAAOE,OAAOT,EAAG,MAAM,CAACI,YAAY,qEAAqEO,MAAMT,EAAOU,WAAWd,EAAIS,OAAOG,MAAOZ,EAAIS,OAAOE,OAAOX,EAAIO,GAAG,KAAKL,EAAG,OAAO,CAACI,YAAY,cAAcO,MAAMT,EAAOU,WAAWd,EAAIS,OAAOG,MAAOZ,EAAIS,OAAOE,MAAM,CAACX,EAAIO,GAAG,aAAaP,EAAIQ,GAAGJ,EAAOlB,eAAec,EAAIS,OAAOE,MAAM,iBAAiBX,EAAIe,WAEl/B,IDSpB,EACA,KACA,KACA,M,SFHF,OACA,SACA,YACA,8BAEA,mBACA,YACA,6BAEA,YACA,YACA,0BACA,oCACA,4CACA,4CACA,8CACA,sCACA,qCACA,4BAIA,MAxBA,SAwBA,GACA,QACA,qBAEA,sBAHA,iBAGA,oBAHA,wBAKA,gBACA,sBACA,qCAFA,IAIA,QAJA,WAIA,WACA,+BACA,GACA,4EAGA,qEAEA,iCACA,+CACA,oBACA,+CACA,eACA,yDACA,+CAIA,SACA,cADA,SACA,cACA,mCACA,SAEA,qCAyCA,OACA,OAzCA,6BACA,uEACA,yCACA,yBACA,MACA,yBACA,yBACA,kEACA,EACA,WAGA,yEACA,kDAEA,kEACA,6CAEA,kDAwBA,SAtBA,qCACA,eACA,UACA,cACA,GADA,IAEA,iBACA,aACA,4CAEA,WACA,cACA,GADA,IAEA,kBACA,wBACA,4CAEA,QACA,eAQA,gBAnDA,SAmDA,cACA,KAYA,OAXA,kCACA,aACA,kBACA,4BACA,kCACA,kBACA,gDAKA,CACA,yBACA,eIxHI,EAAY,YACd,GRRW,WAAkB,IAAIf,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACI,YAAY,0IAA0IN,EAAIgB,GAAIhB,EAAW,SAAE,SAASS,GAAQ,OAAOP,EAAG,MAAM,CAACf,IAAIsB,EAAOE,IAAIL,YAAY,uBAAuB,CAACJ,EAAG,aAAa,CAACe,MAAM,CAAC,OAASR,EAAO,sBAAsBT,EAAIjB,qBAAqBiB,EAAIO,GAAG,KAAKL,EAAG,MAAM,CAACI,YAAY,aAAa,CAAEN,EAAIkB,cAAcC,WAAWV,EAAOE,KAAMT,EAAG,qBAAqB,CAACI,YAAY,UAAUW,MAAM,CAAC,QAAUjB,EAAIoB,GAAG,2BAA2BlB,EAAG,MAAM,CAACI,YAAY,yCAAyC,CAAEN,EAAIkB,cAAcG,KAAKZ,EAAOE,KAAW,OAAET,EAAG,WAAW,CAACI,YAAY,cAAcW,MAAM,CAAC,WAAajB,EAAIsB,cAAcb,GAAQ,gBAAgBT,EAAIuB,gBAAgBd,MAAWP,EAAG,OAAO,CAACI,YAAY,0BAA0B,CAACN,EAAIO,GAAG,eAAeP,EAAIQ,GAAGR,EAAIoB,GAAG,0BAA0B,iBAAiB,IAAI,IAAI,MAAK,KAE38B,IQSpB,EACA,KACA,KACA,MAIa,M,2CClBf,ICAyP,E,qNCOrPI,EAAY,YACd,GFRW,WAAkB,IAAIxB,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAUF,EAAIG,MAAME,YAAY,OAAOH,EAAG,MAAM,CAACuB,IAAI,wBAAwBnB,YAAY,UAAUO,MAAM,CAC9J,2CAA4Cb,EAAI0B,WAC/C,CAACxB,EAAG,KAAK,CAACI,YAAY,gFAAgF,CAACJ,EAAG,OAAO,CAACuB,IAAI,qBAAqB,CAACzB,EAAIO,GAAGP,EAAIQ,GAAGR,EAAI2B,UAAU3B,EAAIO,GAAG,KAAKL,EAAG,cAAc,CAAC0B,WAAW,CAAC,CAACC,KAAK,UAAUC,QAAQ,YAAY1C,MAAOY,EAAY,SAAE+B,WAAW,aAAaN,IAAI,mBAAmBnB,YAAY,sDAAsDW,MAAM,CAAC,KAAO,KAAK,KAAO,WAAW,GAAGjB,EAAIO,GAAG,KAAKL,EAAG,KAAK,CAACuB,IAAI,oBAAoBnB,YAAY,mEAAmE,CAACN,EAAIO,GAAG,SAASP,EAAIQ,GAAGR,EAAIZ,OAAO,cAEljB,IEOpB,EACA,KACA,KACA,MAIa,IAAAoC,E,uGClBf,I,2CCAmP,E,yFCY7OQ,EAAoB,cAAI,KACxBC,EAAe,cAAI,KACnBC,EAAiB,cAAI,KACrBC,EAAc,cAAI,KAMlBC,EAAe,WACdrC,EAAMsC,QAAQC,IAAOvC,EAAMsC,QAAQE,MAGxC,IAAWC,cAAczC,EAAMsC,SAASI,MAAK,SAAAC,GAC3CV,EAAkB5C,MAAQsD,EAASrB,KAAKsB,mBAAmB7C,iBAC3DmC,EAAa7C,MAAQsD,EAASrB,KAAKuB,cAAc9C,iBACjDoC,EAAe9C,MAAQsD,EAASrB,KAAKwB,gBAAgBC,WACrDX,EAAY/C,MAAQsD,EAASrB,KAAK0B,aAAaD,e,OAInD,iBAAM,kBAAM/C,EAAMsC,UAASD,EAAc,CAAEY,MAAM,IAEjD,oBAAUZ,G,oGAlBc,SAAAhD,GACtB,OAAOA,EAAK,UAAMA,EAAN,KAAiB,M,8CCAhB,EAXC,YACd,GCRW,WAAkB,IAAIY,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAGE,EAAOJ,EAAIG,MAAME,YAAY,OAAOH,EAAG,MAAM,CAACI,YAAY,mIAAmI,CAACJ,EAAGE,EAAO6C,iBAAiB,CAAC3C,YAAY,SAASW,MAAM,CAAC,MAAQjB,EAAIoB,GAAG,gDAAgD,YAAYpB,EAAIoB,GAAG,kDAAkD,MAAQhB,EAAO4B,qBAAqBhC,EAAIO,GAAG,KAAKL,EAAGE,EAAO6C,iBAAiB,CAAC3C,YAAY,SAASW,MAAM,CAAC,MAAQjB,EAAIoB,GAAG,4CAA4C,YAAYpB,EAAIoB,GAAG,8CAA8C,MAAQhB,EAAO6B,gBAAgBjC,EAAIO,GAAG,KAAKL,EAAGE,EAAO6C,iBAAiB,CAAC3C,YAAY,SAASW,MAAM,CAAC,MAAQjB,EAAIoB,GAAG,4CAA4C,YAAYpB,EAAIoB,GAAG,8CAA8C,MAAQhB,EAAO8C,gBAAgB9C,EAAO8B,mBAAmBlC,EAAIO,GAAG,KAAKL,EAAGE,EAAO6C,iBAAiB,CAAC3C,YAAY,SAASW,MAAM,CAAC,MAAQjB,EAAIoB,GAAG,yCAAyC,YAAYpB,EAAIoB,GAAG,2CAA2C,MAAQhB,EAAO8C,gBAAgB9C,EAAO+B,iBAAiB,KAE7oC,IDSpB,EACA,KACA,KACA,M,81BENF,OACA,kBACA,YACA,aACA,yBACA,qBAEA,KAPA,WAQA,OACA,OACA,KACA,eACA,YACA,6CACA,wCAEA,mBAGA,UACA,eADA,WAEA,OACA,eACA,cAIA,SACA,aADA,WAEA,uBACA,uBAEA,gBALA,WAMA,IACA,iEACA,SACA,yDAGA,eAZA,WAYA,WACA,oD,EAAA,G,EAAA,gJAEC,EAAD,wCACA,wBACA,wBAJA,sDAOA,iDAPA,uD,+KAAA,wDAWA,kBAxBA,WAyBA,8DAEA,OACA,OACA,KACA,6CACA,kBAGA,eAlCA,YAkCA,kDACA,YACA,UACA,eACA,qBACA,oBAEA,+BACA,oDACA,uBC9EkO,ICO9N,EAAY,YACd,GPRW,WAAkB,IAAInC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACI,YAAY,4BAA4B,CAACJ,EAAG,uBAAuB,CAACe,MAAM,CAAC,sBAAqB,EAAM,uBAAuB,GAAG,8BAA6B,GAAOkC,GAAG,CAAC,aAAenD,EAAIoD,kBAAkBpD,EAAIO,GAAG,KAAKL,EAAG,aAAa,CAACe,MAAM,CAAC,QAAUjB,EAAIqD,kBAAkBrD,EAAIO,GAAG,KAAKL,EAAG,kBAAkB,CAACe,MAAM,CAAC,sBAAsB,gBAAgB,WAAWjB,EAAIsD,QAAQ,cAActD,EAAIuD,eAAe,KAE/c,IOSpB,EACA,KACA,KACA,MAIa,Y","file":"js/102-132598b2467592fa6597.chunk.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"grid grid-cols-1 p-2 bg-white border rounded-md md:grid-cols-2 lg:grid-cols-3 dark:bg-slate-800 border-slate-100 dark:border-slate-700\"},_vm._l((_vm.metrics),function(metric){return _c('div',{key:metric.KEY,staticClass:\"p-4 mb-3 rounded-md\"},[_c('ChartStats',{attrs:{\"metric\":metric,\"account-summary-key\":_vm.accountSummaryKey}}),_vm._v(\" \"),_c('div',{staticClass:\"mt-4 h-72\"},[(_vm.accountReport.isFetching[metric.KEY])?_c('woot-loading-state',{staticClass:\"text-xs\",attrs:{\"message\":_vm.$t('REPORT.LOADING_CHART')}}):_c('div',{staticClass:\"flex items-center justify-center h-72\"},[(_vm.accountReport.data[metric.KEY].length)?_c('woot-bar',{staticClass:\"w-full h-72\",attrs:{\"collection\":_vm.getCollection(metric),\"chart-options\":_vm.getChartOptions(metric)}}):_c('span',{staticClass:\"text-sm text-slate-600\"},[_vm._v(\"\\n          \"+_vm._s(_vm.$t('REPORT.NO_ENOUGH_DATA'))+\"\\n        \")])],1)],1)],1)}),0)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { useMapGetter } from 'dashboard/composables/store';\nimport { formatTime } from '@chatwoot/utils';\n\n/**\n * A composable function for report metrics calculations and display.\n *\n * @param {string} [accountSummaryKey='getAccountSummary'] - The key for accessing account summary data.\n * @returns {Object} An object containing utility functions for report metrics.\n */\nexport function useReportMetrics(accountSummaryKey = 'getAccountSummary') {\n  const accountSummary = useMapGetter(accountSummaryKey);\n\n  /**\n   * Calculates the trend percentage for a given metric.\n   *\n   * @param {string} key - The key of the metric to calculate trend for.\n   * @returns {number} The calculated trend percentage, rounded to the nearest integer.\n   */\n  const calculateTrend = key => {\n    if (!accountSummary.value.previous[key]) return 0;\n    const diff = accountSummary.value[key] - accountSummary.value.previous[key];\n    return Math.round((diff / accountSummary.value.previous[key]) * 100);\n  };\n\n  /**\n   * Checks if a given metric key represents an average metric type.\n   *\n   * @param {string} key - The key of the metric to check.\n   * @returns {boolean} True if the metric is an average type, false otherwise.\n   */\n  const isAverageMetricType = key => {\n    return [\n      'avg_first_response_time',\n      'avg_resolution_time',\n      'reply_time',\n    ].includes(key);\n  };\n\n  /**\n   * Formats and displays a metric value based on its type.\n   *\n   * @param {string} key - The key of the metric to display.\n   * @returns {string} The formatted metric value as a string.\n   */\n  const displayMetric = key => {\n    if (isAverageMetricType(key)) {\n      return formatTime(accountSummary.value[key]);\n    }\n    return Number(accountSummary.value[key] || '').toLocaleString();\n  };\n\n  return {\n    calculateTrend,\n    isAverageMetricType,\n    displayMetric,\n  };\n}\n","import mod from \"-!../../../../../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChartStats.vue?vue&type=script&setup=true&lang=js&\"; export default mod; export * from \"-!../../../../../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChartStats.vue?vue&type=script&setup=true&lang=js&\"","<script setup>\nimport { useReportMetrics } from 'dashboard/composables/useReportMetrics';\n\nconst props = defineProps({\n  metric: {\n    type: Object,\n    default: () => ({}),\n  },\n  accountSummaryKey: {\n    type: String,\n    default: 'getAccountSummary',\n  },\n});\n\nconst { calculateTrend, displayMetric, isAverageMetricType } = useReportMetrics(\n  props.accountSummaryKey\n);\n\nconst trendColor = (value, key) => {\n  if (isAverageMetricType(key)) {\n    return value > 0\n      ? 'border-red-500 text-red-500'\n      : 'border-green-500 text-green-500';\n  }\n  return value < 0\n    ? 'border-red-500 text-red-500'\n    : 'border-green-500 text-green-500';\n};\n</script>\n\n<template>\n  <div class=\"text-slate-900 dark:text-slate-100\">\n    <span class=\"text-sm\">\n      {{ metric.NAME }}\n    </span>\n    <div class=\"flex items-end\">\n      <div class=\"text-xl font-medium\">\n        {{ displayMetric(metric.KEY) }}\n      </div>\n      <div v-if=\"metric.trend\" class=\"text-xs ml-4 flex items-center mb-0.5\">\n        <div\n          v-if=\"metric.trend < 0\"\n          class=\"h-0 w-0 border-x-4 medium border-x-transparent border-t-[8px] mr-1\"\n          :class=\"trendColor(metric.trend, metric.KEY)\"\n        />\n        <div\n          v-else\n          class=\"h-0 w-0 border-x-4 medium border-x-transparent border-b-[8px] mr-1\"\n          :class=\"trendColor(metric.trend, metric.KEY)\"\n        />\n        <span class=\"font-medium\" :class=\"trendColor(metric.trend, metric.KEY)\">\n          {{ calculateTrend(metric.KEY) }}%\n        </span>\n      </div>\n    </div>\n  </div>\n</template>\n","<script>\nimport { mapGetters } from 'vuex';\nimport { useReportMetrics } from 'dashboard/composables/useReportMetrics';\nimport { GROUP_BY_FILTER, METRIC_CHART } from './constants';\nimport fromUnixTime from 'date-fns/fromUnixTime';\nimport format from 'date-fns/format';\nimport { formatTime } from '@chatwoot/utils';\nimport ChartStats from './components/ChartElements/ChartStats.vue';\n\nexport default {\n  components: { ChartStats },\n  props: {\n    groupBy: {\n      type: Object,\n      default: () => ({}),\n    },\n    accountSummaryKey: {\n      type: String,\n      default: 'getAccountSummary',\n    },\n    reportKeys: {\n      type: Object,\n      default: () => ({\n        CONVERSATIONS: 'conversations_count',\n        INCOMING_MESSAGES: 'incoming_messages_count',\n        OUTGOING_MESSAGES: 'outgoing_messages_count',\n        FIRST_RESPONSE_TIME: 'avg_first_response_time',\n        RESOLUTION_TIME: 'avg_resolution_time',\n        RESOLUTION_COUNT: 'resolutions_count',\n        REPLY_TIME: 'reply_time',\n      }),\n    },\n  },\n  setup(props) {\n    const { calculateTrend, isAverageMetricType } = useReportMetrics(\n      props.accountSummaryKey\n    );\n    return { calculateTrend, isAverageMetricType };\n  },\n  computed: {\n    ...mapGetters({\n      accountReport: 'getAccountReports',\n    }),\n    metrics() {\n      const reportKeys = Object.keys(this.reportKeys);\n      const infoText = {\n        FIRST_RESPONSE_TIME: this.$t(\n          `REPORT.METRICS.FIRST_RESPONSE_TIME.INFO_TEXT`\n        ),\n        RESOLUTION_TIME: this.$t(`REPORT.METRICS.RESOLUTION_TIME.INFO_TEXT`),\n      };\n      return reportKeys.map(key => ({\n        NAME: this.$t(`REPORT.METRICS.${key}.NAME`),\n        KEY: this.reportKeys[key],\n        DESC: this.$t(`REPORT.METRICS.${key}.DESC`),\n        INFO_TEXT: infoText[key],\n        TOOLTIP_TEXT: `REPORT.METRICS.${key}.TOOLTIP_TEXT`,\n        trend: this.calculateTrend(this.reportKeys[key]),\n      }));\n    },\n  },\n  methods: {\n    getCollection(metric) {\n      if (!this.accountReport.data[metric.KEY]) {\n        return {};\n      }\n      const data = this.accountReport.data[metric.KEY];\n      const labels = data.map(element => {\n        if (this.groupBy?.period === GROUP_BY_FILTER[2].period) {\n          let week_date = new Date(fromUnixTime(element.timestamp));\n          const first_day = week_date.getDate() - week_date.getDay();\n          const last_day = first_day + 6;\n          const week_first_date = new Date(week_date.setDate(first_day));\n          const week_last_date = new Date(week_date.setDate(last_day));\n          return `${format(week_first_date, 'dd-MMM')} - ${format(\n            week_last_date,\n            'dd-MMM'\n          )}`;\n        }\n        if (this.groupBy?.period === GROUP_BY_FILTER[3].period) {\n          return format(fromUnixTime(element.timestamp), 'MMM-yyyy');\n        }\n        if (this.groupBy?.period === GROUP_BY_FILTER[4].period) {\n          return format(fromUnixTime(element.timestamp), 'yyyy');\n        }\n        return format(fromUnixTime(element.timestamp), 'dd-MMM');\n      });\n      const datasets = METRIC_CHART[metric.KEY].datasets.map(dataset => {\n        switch (dataset.type) {\n          case 'bar':\n            return {\n              ...dataset,\n              yAxisID: 'y-left',\n              label: metric.NAME,\n              data: data.map(element => element.value),\n            };\n          case 'line':\n            return {\n              ...dataset,\n              yAxisID: 'y-right',\n              label: this.metrics[0].NAME,\n              data: data.map(element => element.count),\n            };\n          default:\n            return dataset;\n        }\n      });\n      return {\n        labels,\n        datasets,\n      };\n    },\n    getChartOptions(metric) {\n      let tooltips = {};\n      if (this.isAverageMetricType(metric.KEY)) {\n        tooltips.callbacks = {\n          label: tooltipItem => {\n            return this.$t(metric.TOOLTIP_TEXT, {\n              metricValue: formatTime(tooltipItem.yLabel),\n              conversationCount:\n                this.accountReport.data[metric.KEY][tooltipItem.index].count,\n            });\n          },\n        };\n      }\n      return {\n        scales: METRIC_CHART[metric.KEY].scales,\n        tooltips: tooltips,\n      };\n    },\n  },\n};\n</script>\n\n<template>\n  <div\n    class=\"grid grid-cols-1 p-2 bg-white border rounded-md md:grid-cols-2 lg:grid-cols-3 dark:bg-slate-800 border-slate-100 dark:border-slate-700\"\n  >\n    <div\n      v-for=\"metric in metrics\"\n      :key=\"metric.KEY\"\n      class=\"p-4 mb-3 rounded-md\"\n    >\n      <ChartStats :metric=\"metric\" :account-summary-key=\"accountSummaryKey\" />\n      <div class=\"mt-4 h-72\">\n        <woot-loading-state\n          v-if=\"accountReport.isFetching[metric.KEY]\"\n          class=\"text-xs\"\n          :message=\"$t('REPORT.LOADING_CHART')\"\n        />\n        <div v-else class=\"flex items-center justify-center h-72\">\n          <woot-bar\n            v-if=\"accountReport.data[metric.KEY].length\"\n            :collection=\"getCollection(metric)\"\n            :chart-options=\"getChartOptions(metric)\"\n            class=\"w-full h-72\"\n          />\n          <span v-else class=\"text-sm text-slate-600\">\n            {{ $t('REPORT.NO_ENOUGH_DATA') }}\n          </span>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n","import mod from \"-!../../../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ReportContainer.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ReportContainer.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ChartStats.vue?vue&type=template&id=9c8a8680&\"\nimport script from \"./ChartStats.vue?vue&type=script&setup=true&lang=js&\"\nexport * from \"./ChartStats.vue?vue&type=script&setup=true&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"text-slate-900 dark:text-slate-100\"},[_c('span',{staticClass:\"text-sm\"},[_vm._v(\"\\n    \"+_vm._s(_vm.metric.NAME)+\"\\n  \")]),_vm._v(\" \"),_c('div',{staticClass:\"flex items-end\"},[_c('div',{staticClass:\"text-xl font-medium\"},[_vm._v(\"\\n      \"+_vm._s(_setup.displayMetric(_vm.metric.KEY))+\"\\n    \")]),_vm._v(\" \"),(_vm.metric.trend)?_c('div',{staticClass:\"text-xs ml-4 flex items-center mb-0.5\"},[(_vm.metric.trend < 0)?_c('div',{staticClass:\"h-0 w-0 border-x-4 medium border-x-transparent border-t-[8px] mr-1\",class:_setup.trendColor(_vm.metric.trend, _vm.metric.KEY)}):_c('div',{staticClass:\"h-0 w-0 border-x-4 medium border-x-transparent border-b-[8px] mr-1\",class:_setup.trendColor(_vm.metric.trend, _vm.metric.KEY)}),_vm._v(\" \"),_c('span',{staticClass:\"font-medium\",class:_setup.trendColor(_vm.metric.trend, _vm.metric.KEY)},[_vm._v(\"\\n        \"+_vm._s(_setup.calculateTrend(_vm.metric.KEY))+\"%\\n      \")])]):_vm._e()])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./ReportContainer.vue?vue&type=template&id=5a48177a&\"\nimport script from \"./ReportContainer.vue?vue&type=script&lang=js&\"\nexport * from \"./ReportContainer.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{ref:\"reportMetricContainer\",staticClass:\"p-4 m-0\",class:{\n    'grayscale pointer-events-none opacity-30': _vm.disabled,\n  }},[_c('h3',{staticClass:\"flex items-center m-0 text-sm font-medium text-slate-800 dark:text-slate-100\"},[_c('span',{ref:\"reportMetricLabel\"},[_vm._v(_vm._s(_vm.label))]),_vm._v(\" \"),_c('fluent-icon',{directives:[{name:\"tooltip\",rawName:\"v-tooltip\",value:(_vm.infoText),expression:\"infoText\"}],ref:\"reportMetricInfo\",staticClass:\"text-slate-500 dark:text-slate-200 my-0 mx-1 mt-0.5\",attrs:{\"size\":\"14\",\"icon\":\"info\"}})],1),_vm._v(\" \"),_c('h4',{ref:\"reportMetricValue\",staticClass:\"mt-1 mb-0 text-3xl font-thin text-slate-700 dark:text-slate-100\"},[_vm._v(\"\\n    \"+_vm._s(_vm.value)+\"\\n  \")])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ReportMetricCard.vue?vue&type=script&setup=true&lang=js&\"; export default mod; export * from \"-!../../../../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ReportMetricCard.vue?vue&type=script&setup=true&lang=js&\"","import { render, staticRenderFns } from \"./ReportMetricCard.vue?vue&type=template&id=2b972ecd&\"\nimport script from \"./ReportMetricCard.vue?vue&type=script&setup=true&lang=js&\"\nexport * from \"./ReportMetricCard.vue?vue&type=script&setup=true&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"flex-1 p-4 overflow-auto\"},[_c('ReportFilterSelector',{attrs:{\"show-agents-filter\":false,\"show-group-by-filter\":\"\",\"show-business-hours-switch\":false},on:{\"filterChange\":_vm.onFilterChange}}),_vm._v(\" \"),_c('BotMetrics',{attrs:{\"filters\":_vm.requestPayload}}),_vm._v(\" \"),_c('ReportContainer',{attrs:{\"account-summary-key\":\"getBotSummary\",\"group-by\":_vm.groupBy,\"report-keys\":_vm.reportKeys}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BotMetrics.vue?vue&type=script&setup=true&lang=js&\"; export default mod; export * from \"-!../../../../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BotMetrics.vue?vue&type=script&setup=true&lang=js&\"","<script setup>\nimport { ref, watch, onMounted } from 'vue';\nimport ReportMetricCard from './ReportMetricCard.vue';\nimport ReportsAPI from 'dashboard/api/reports';\n\nconst props = defineProps({\n  filters: {\n    type: Object,\n    required: true,\n  },\n});\n\nconst conversationCount = ref('0');\nconst messageCount = ref('0');\nconst resolutionRate = ref('0');\nconst handoffRate = ref('0');\n\nconst formatToPercent = value => {\n  return value ? `${value}%` : '--';\n};\n\nconst fetchMetrics = () => {\n  if (!props.filters.to || !props.filters.from) {\n    return;\n  }\n  ReportsAPI.getBotMetrics(props.filters).then(response => {\n    conversationCount.value = response.data.conversation_count.toLocaleString();\n    messageCount.value = response.data.message_count.toLocaleString();\n    resolutionRate.value = response.data.resolution_rate.toString();\n    handoffRate.value = response.data.handoff_rate.toString();\n  });\n};\n\nwatch(() => props.filters, fetchMetrics, { deep: true });\n\nonMounted(fetchMetrics);\n</script>\n\n<template>\n  <div\n    class=\"flex flex-wrap mx-0 bg-white dark:bg-slate-800 rounded-[4px] p-4 mb-5 border border-solid border-slate-75 dark:border-slate-700\"\n  >\n    <ReportMetricCard\n      :label=\"$t('BOT_REPORTS.METRIC.TOTAL_CONVERSATIONS.LABEL')\"\n      :info-text=\"$t('BOT_REPORTS.METRIC.TOTAL_CONVERSATIONS.TOOLTIP')\"\n      :value=\"conversationCount\"\n      class=\"flex-1\"\n    />\n    <ReportMetricCard\n      :label=\"$t('BOT_REPORTS.METRIC.TOTAL_RESPONSES.LABEL')\"\n      :info-text=\"$t('BOT_REPORTS.METRIC.TOTAL_RESPONSES.TOOLTIP')\"\n      :value=\"messageCount\"\n      class=\"flex-1\"\n    />\n    <ReportMetricCard\n      :label=\"$t('BOT_REPORTS.METRIC.RESOLUTION_RATE.LABEL')\"\n      :info-text=\"$t('BOT_REPORTS.METRIC.RESOLUTION_RATE.TOOLTIP')\"\n      :value=\"formatToPercent(resolutionRate)\"\n      class=\"flex-1\"\n    />\n    <ReportMetricCard\n      :label=\"$t('BOT_REPORTS.METRIC.HANDOFF_RATE.LABEL')\"\n      :info-text=\"$t('BOT_REPORTS.METRIC.HANDOFF_RATE.TOOLTIP')\"\n      :value=\"formatToPercent(handoffRate)\"\n      class=\"flex-1\"\n    />\n  </div>\n</template>\n","import { render, staticRenderFns } from \"./BotMetrics.vue?vue&type=template&id=4c79aaa8&\"\nimport script from \"./BotMetrics.vue?vue&type=script&setup=true&lang=js&\"\nexport * from \"./BotMetrics.vue?vue&type=script&setup=true&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"flex flex-wrap mx-0 bg-white dark:bg-slate-800 rounded-[4px] p-4 mb-5 border border-solid border-slate-75 dark:border-slate-700\"},[_c(_setup.ReportMetricCard,{staticClass:\"flex-1\",attrs:{\"label\":_vm.$t('BOT_REPORTS.METRIC.TOTAL_CONVERSATIONS.LABEL'),\"info-text\":_vm.$t('BOT_REPORTS.METRIC.TOTAL_CONVERSATIONS.TOOLTIP'),\"value\":_setup.conversationCount}}),_vm._v(\" \"),_c(_setup.ReportMetricCard,{staticClass:\"flex-1\",attrs:{\"label\":_vm.$t('BOT_REPORTS.METRIC.TOTAL_RESPONSES.LABEL'),\"info-text\":_vm.$t('BOT_REPORTS.METRIC.TOTAL_RESPONSES.TOOLTIP'),\"value\":_setup.messageCount}}),_vm._v(\" \"),_c(_setup.ReportMetricCard,{staticClass:\"flex-1\",attrs:{\"label\":_vm.$t('BOT_REPORTS.METRIC.RESOLUTION_RATE.LABEL'),\"info-text\":_vm.$t('BOT_REPORTS.METRIC.RESOLUTION_RATE.TOOLTIP'),\"value\":_setup.formatToPercent(_setup.resolutionRate)}}),_vm._v(\" \"),_c(_setup.ReportMetricCard,{staticClass:\"flex-1\",attrs:{\"label\":_vm.$t('BOT_REPORTS.METRIC.HANDOFF_RATE.LABEL'),\"info-text\":_vm.$t('BOT_REPORTS.METRIC.HANDOFF_RATE.TOOLTIP'),\"value\":_setup.formatToPercent(_setup.handoffRate)}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\nimport { useAlert } from 'dashboard/composables';\nimport BotMetrics from './components/BotMetrics.vue';\nimport ReportFilterSelector from './components/FilterSelector.vue';\nimport { GROUP_BY_FILTER } from './constants';\nimport ReportContainer from './ReportContainer.vue';\nimport { REPORTS_EVENTS } from '../../../../helper/AnalyticsHelper/events';\n\nexport default {\n  name: 'BotReports',\n  components: {\n    BotMetrics,\n    ReportFilterSelector,\n    ReportContainer,\n  },\n  data() {\n    return {\n      from: 0,\n      to: 0,\n      groupBy: GROUP_BY_FILTER[1],\n      reportKeys: {\n        BOT_RESOLUTION_COUNT: 'bot_resolutions_count',\n        BOT_HANDOFF_COUNT: 'bot_handoffs_count',\n      },\n      businessHours: false,\n    };\n  },\n  computed: {\n    requestPayload() {\n      return {\n        from: this.from,\n        to: this.to,\n      };\n    },\n  },\n  methods: {\n    fetchAllData() {\n      this.fetchBotSummary();\n      this.fetchChartData();\n    },\n    fetchBotSummary() {\n      try {\n        this.$store.dispatch('fetchBotSummary', this.getRequestPayload());\n      } catch {\n        useAlert(this.$t('REPORT.SUMMARY_FETCHING_FAILED'));\n      }\n    },\n    fetchChartData() {\n      Object.keys(this.reportKeys).forEach(async key => {\n        try {\n          await this.$store.dispatch('fetchAccountReport', {\n            metric: this.reportKeys[key],\n            ...this.getRequestPayload(),\n          });\n        } catch {\n          useAlert(this.$t('REPORT.DATA_FETCHING_FAILED'));\n        }\n      });\n    },\n    getRequestPayload() {\n      const { from, to, groupBy, businessHours } = this;\n\n      return {\n        from,\n        to,\n        groupBy: groupBy?.period,\n        businessHours,\n      };\n    },\n    onFilterChange({ from, to, groupBy, businessHours }) {\n      this.from = from;\n      this.to = to;\n      this.groupBy = groupBy;\n      this.businessHours = businessHours;\n      this.fetchAllData();\n\n      this.$track(REPORTS_EVENTS.FILTER_REPORT, {\n        filterValue: { from, to, groupBy, businessHours },\n        reportType: 'bots',\n      });\n    },\n  },\n};\n</script>\n\n<template>\n  <div class=\"flex-1 p-4 overflow-auto\">\n    <ReportFilterSelector\n      :show-agents-filter=\"false\"\n      show-group-by-filter\n      :show-business-hours-switch=\"false\"\n      @filterChange=\"onFilterChange\"\n    />\n\n    <BotMetrics :filters=\"requestPayload\" />\n    <ReportContainer\n      account-summary-key=\"getBotSummary\"\n      :group-by=\"groupBy\"\n      :report-keys=\"reportKeys\"\n    />\n  </div>\n</template>\n","import mod from \"-!../../../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BotReports.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BotReports.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./BotReports.vue?vue&type=template&id=13783c4b&\"\nimport script from \"./BotReports.vue?vue&type=script&lang=js&\"\nexport * from \"./BotReports.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}